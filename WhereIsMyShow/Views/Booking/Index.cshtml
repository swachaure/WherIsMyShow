@model ShowBooking

@{
    ViewData["Title"] = "Create Booking";
}
<style>
    html, body {
        margin: 0;
        padding: 0;
        font-family: Arial, Helvetica Neue, Helvetica, sans-serif;
        font-size: 14px;
    }

    #calendar {
        max-width: 1100px;
        margin: 40px auto;
    }
    .fc-event-time {
        display: none;
    }
</style>
<h1 class="text-info text-center">Calendar  Booking for @Model.ShowName</h1>

<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <form asp-action="Create" method="post">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Booking on Date @Model.EndDate.ToShortDateString() for @Model.ShowName</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">

                    <input asp-for="ShowId" type="hidden" value="@Model.ShowId" />
                    <input asp-for="StartDate" type="hidden" value="@Model.StartDate" />
                    <input asp-for="EndDate" type="hidden" value="@Model.StartDate" />
                    <input asp-for="ShowName" type="hidden" value="@Model.ShowName" />
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label asp-for="Name"></label>
                                <input asp-for="Name" class="form-control" />
                                <span asp-validation-for="Name" class="text-danger"></span>
                            </div>
                        </div>
                       
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label asp-for="PhoneNumber"></label>
                                    <input asp-for="PhoneNumber" class="form-control" />
                                    <span asp-validation-for="PhoneNumber" class="text-danger"></span>
                                </div>
                            </div>
                          
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label asp-for="EmailAddress"></label>
                                        <input asp-for="EmailAddress" class="form-control" />
                                        <span asp-validation-for="EmailAddress" class="text-danger"></span>
                                    </div>
                                </div>
                                
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label asp-for="NumberOfTickets"></label>
                                            <input asp-for="NumberOfTickets" class="form-control" />
                                            <span asp-validation-for="NumberOfTickets" class="text-danger"></span>
                                        </div>
                                    </div>
                                    

                                </div>
                    </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-danger btn-sm" data-dismiss="modal">Close</button>
                                    <button type="submit" class="btn btn-success btn-sm">Confirm booking</button>
                                </div>
                            </div>
        </form>
    </div>
</div>

    <div id='calendar'></div>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function () {
        var calendarEl = document.getElementById('calendar');
        var startdate = "@(Model.StartDate.Year)-@(Model.StartDate.Month)-@(Model.StartDate.Day)";
        var enddate = "@(Model.EndDate.Year)-@(Model.EndDate.Month)-@(Model.EndDate.Day)";
        var showname = "@(Model.ShowName)";
        var jsstartdate = new Date(startdate);
        var jsenddate = new Date(enddate);


        var calendar = new FullCalendar.Calendar(calendarEl, {
            initialView: 'dayGridMonth',
            initialDate: jsstartdate,
            eventColor: 'green',
            dateClick: function (info) {
               
                var currentdate = info.date;
                if (currentdate >= jsstartdate && currentdate < jsenddate) {
                    var answer = window.confirm("Are you sure you want to  book  on date?" + info.dateStr);
                    if (answer) {
                        const form = document.querySelector('form');
                        document.getElementById("StartDate").value = currentdate.toISOString();
                        $('#exampleModal').modal('show');

                       // form.submit();
                    }

                }
                else {
                    alert('Invalid Date Select Green dates to book ');
                }
                
               
            },
            events: [

                {
                    title: showname,
                    start: jsstartdate,
                    end: jsenddate
                }

            ]
        });

        calendar.render();
    });
    </script>
